# ===========================
# ğŸ§® EstimaciÃ³n de tamaÃ±o muestral e IC
# VersiÃ³n Gretl 2025b - ParÃ¡metros calibrados
# ===========================

# === ParÃ¡metros poblacionales y de diseÃ±o ===
scalar sigma  = 100        # DesvÃ­o estÃ¡ndar poblacional
scalar sigma2 = sigma^2
scalar E      = 15         # Error mÃ¡ximo aceptable
scalar Z      = 1.96       # Valor z (95% de confianza)
scalar N      = 500        # TamaÃ±o de poblaciÃ³n finita
scalar media  = 20         # Nueva media poblacional esperada

# === MÃ©todo A ===
scalar n_A1 = (Z^2 * sigma2) / E^2
scalar n_A  = n_A1 / (1 + (n_A1 / N))

# === MÃ©todo B ===
scalar n_B = (N * Z^2 * sigma2) / (N * E^2 + Z^2 * sigma2)

# === MÃ©todo C ===
scalar n_C = sigma2 / ((E / Z)^2 + (sigma2 / N))

# === MÃ©todo D: mÃ³dulo redondeado ===
scalar n0 = (Z^2 * sigma2) / E^2
scalar n_D = n0 / (1 + n0 / N)
scalar n_redondeado = ceil(n_D)

# === ComparaciÃ³n de tamaÃ±os muestrales ===
printf "\nğŸš€ ==== TamaÃ±os muestrales estimados ====\n"
printf "ğŸ“Š MÃ©todo A: %.3f\n", n_A
printf "ğŸ“Š MÃ©todo B: %.3f\n", n_B
printf "ğŸ“Š MÃ©todo C: %.3f\n", n_C
printf "ğŸ“Š MÃ©todo D (redondeado): %d\n", n_redondeado

# === Intervalo de confianza corregido ===
scalar f      = n_redondeado / N
scalar margen = Z * sigma / sqrt(n_redondeado) * sqrt(1 - f)
scalar inf    = media - margen
scalar sup    = media + margen

# === Resultados del intervalo de confianza ===
printf "\nğŸ“ Intervalo de confianza al 95%% (n = %d):\n", n_redondeado
printf "Media esperada: %.2f\n", media
printf "Margen de error corregido: %.2f\n", margen
printf "LÃ­mite inferior: %.2f\n", inf
printf "LÃ­mite superior: %.2f\n", sup
